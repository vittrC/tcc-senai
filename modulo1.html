<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Curso 3 - Inteligência Emocional</title>
  <link rel="stylesheet" href="css/styleModulo1.css">
  <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0,0" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body>

  <div class="banner">
    <span>CURSO DE INTELIGÊNCIA EMOCIONAL</span>
    <button class="logout-btn" id="logoutBtn">SAIR</button>
  </div>

  <div class="user-info">
    <span>Bem-vindo, </span>
    <span class="user-name" id="userName"></span>
  </div>

  <main>
    <h1>Módulo 1: Introdução à Inteligência Emocional</h1>

    <p>
      A inteligência emocional é a capacidade de reconhecer, entender e gerenciar as próprias emoções, assim como as emoções dos outros.
    </p>

    <div class="icone-container">
  <div class="emocao-item">
    <span class="material-symbols-outlined">mood_bad</span>
  </div>
  <div class="emocao-item">
    <span class="material-symbols-outlined">sentiment_very_dissatisfied</span>
  </div>
  <div class="emocao-item">
    <span class="material-symbols-outlined">sentiment_very_satisfied</span>
  </div>
</div>

    <p>
      Neste módulo, você terá uma introdução aos seus pilares e sua importância nas relações humanas.
    </p>
   
    <!-- Vídeo -->
    <video id="modulo-video" controls poster="img/Thumbnail.png">
    <source src="videos/video_introducao.mp4" type="video/mp4" />
      Seu navegador não suporta a reprodução de vídeo.
    </video>

     <!-- SLIDER -->
    <div class="slider-container">
      <div class="slider">
        <div class="slides" id="slides">
          <img src="img/int1.png" alt="Imagem 1" />
          <img src="img/int2.png" alt="Imagem 2" />
          <img src="img/int3.png" alt="Imagem 3" />
        </div>
        <div class="nav left" onclick="moveSlide(-1)">&#10094;</div>
        <div class="nav right" onclick="moveSlide(1)">&#10095;</div>
      </div>
    </div>

    <blockquote>
  <p>"Você não pode controlar o que acontece com você, mas pode controlar sua atitude em relação ao que acontece com você."</p>
  <footer>— Brian Tracy, escritor e palestrante</footer>
</blockquote>

    <!-- QUESTIONÁRIO -->
    <div id="questionario-form" class="questionnaire">
      <h2>Questionário sobre a sua percepção emocional</h2>
      <form id="form-mod1">
        <!-- Pergunta 1 -->
        <fieldset>
          <legend id="q1">1. Eu identifico minhas emoções com facilidade.</legend>
          <div class="scale" role="radiogroup" aria-labelledby="q1">
            <label class="scale-item">
              <input type="radio" name="q1" value="1" />
              <span>Nunca</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q1" value="2" />
              <span>Raramente</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q1" value="3" />
              <span>Neutro</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q1" value="4" />
              <span>Frequentemente</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q1" value="5" />
              <span>Sempre</span>
            </label>
          </div>
        </fieldset>

        <!-- Pergunta 2 -->
        <fieldset>
          <legend id="q2">2. Eu consigo expressar meus sentimentos de forma respeitosa e clara.</legend>
          <div class="scale" role="radiogroup" aria-labelledby="q2">
            <label class="scale-item">
              <input type="radio" name="q2" value="1" />
              <span>Nunca</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q2" value="2" />
              <span>Raramente</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q2" value="3" />
              <span>Neutro</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q2" value="4" />
              <span>Frequentemente</span>
            </label>
            <label class="scale-item">
              <input type="radio" name="q2" value="5" />
              <span>Sempre</span>
            </label>
          </div>
        </fieldset>

         <!-- Pergunta 3 -->
<fieldset>
  <legend id="q3">3. Eu consigo manter a calma em situações estressantes.</legend>
  <div class="scale" role="radiogroup" aria-labelledby="q3">
    <label class="scale-item">
      <input type="radio" name="q3" value="1" />
      <span>Nunca</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q3" value="2" />
      <span>Raramente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q3" value="3" />
      <span>Neutro</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q3" value="4" />
      <span>Frequentemente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q3" value="5" />
      <span>Sempre</span>
    </label>
  </div>
</fieldset>

<!-- Pergunta 4 -->
<fieldset>
  <legend id="q4">4. Eu entendo como minhas emoções afetam minhas decisões.</legend>
  <div class="scale" role="radiogroup" aria-labelledby="q4">
    <label class="scale-item">
      <input type="radio" name="q4" value="1" />
      <span>Nunca</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q4" value="2" />
      <span>Raramente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q4" value="3" />
      <span>Neutro</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q4" value="4" />
      <span>Frequentemente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q4" value="5" />
      <span>Sempre</span>
    </label>
  </div>
</fieldset>

<!-- Pergunta 5 -->
<fieldset>
  <legend id="q5">5. Eu percebo quando outras pessoas estão emocionalmente afetadas.</legend>
  <div class="scale" role="radiogroup" aria-labelledby="q5">
    <label class="scale-item">
      <input type="radio" name="q5" value="1" />
      <span>Nunca</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q5" value="2" />
      <span>Raramente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q5" value="3" />
      <span>Neutro</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q5" value="4" />
      <span>Frequentemente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q5" value="5" />
      <span>Sempre</span>
    </label>
  </div>
</fieldset>

<!-- Pergunta 6 -->
<fieldset>
  <legend id="q6">6. Eu consigo me acalmar rapidamente após ficar irritado(a).</legend>
  <div class="scale" role="radiogroup" aria-labelledby="q6">
    <label class="scale-item">
      <input type="radio" name="q6" value="1" />
      <span>Nunca</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q6" value="2" />
      <span>Raramente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q6" value="3" />
      <span>Neutro</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q6" value="4" />
      <span>Frequentemente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q6" value="5" />
      <span>Sempre</span>
    </label>
  </div>
</fieldset>

<!-- Pergunta 7 -->
<fieldset>
  <legend id="q7">7. Eu consigo perceber o que os outros estão sentindo, mesmo quando não dizem nada.</legend>
  <div class="scale" role="radiogroup" aria-labelledby="q7">
    <label class="scale-item">
      <input type="radio" name="q7" value="1" />
      <span>Nunca</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q7" value="2" />
      <span>Raramente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q7" value="3" />
      <span>Neutro</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q7" value="4" />
      <span>Frequentemente</span>
    </label>
    <label class="scale-item">
      <input type="radio" name="q7" value="5" />
      <span>Sempre</span>
    </label>
  </div>
</fieldset>

      <div class="btn-container">
    <button type="submit" id="btn-avancar" class="btn" style="pointer-events: none; opacity: 0.5; cursor: not-allowed;">
      Avançar para o Módulo 2
    </button>
  </div>
</form>
    </div>


  </main>

  <script>
    const firebaseConfig = {
    apiKey: "AIzaSyAVZ-dvyJuGFF4fEHGjS-TrhzBmBslVwNs",
    authDomain: "curso-3-inteligencia-emocional.firebaseapp.com",
    projectId: "curso-3-inteligencia-emocional",
    storageBucket: "curso-3-inteligencia-emocional.appspot.com",
    messagingSenderId: "105031303963",
    appId: "1:105031303963:web:0ecdcddc91fbb0af69c9be"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  document.addEventListener('DOMContentLoaded', () => {
    const user = localStorage.getItem('usuario');
    const userNameEl = document.getElementById('userName');
    const logoutBtn = document.getElementById('logoutBtn');
    const form = document.getElementById('form-mod1');
    const questionnaireEl = document.querySelector('.questionnaire');
    const video = document.getElementById("modulo-video");
    const button = document.getElementById("btn-avancar");

    let videoAssistido = false;

    if (!user) {
      userNameEl.textContent = "Visitante";
      questionnaireEl.innerHTML = `
        <p style="text-align: center; color: #ff3a3a;">
          Você precisa fazer login para acessar este conteúdo. Redirecionando...
        </p>
      `;
      setTimeout(() => {
        window.location.href = "login.html";
      }, 3000);
    } else {
      userNameEl.textContent = user;

      db.collection("usuarios").doc(user).collection("modulos").doc("modulo1").get()
        .then(doc => {
          if (doc.exists) {
            const respostas = doc.data();
            for (let i = 1; i <= 7; i++) {
              const radio = document.querySelector(`input[name="q${i}"][value="${respostas[`q${i}`]}"]`);
              if (radio) radio.checked = true;
            }
          }
        });

      // Logout
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('usuario');
        window.location.href = "modulo2.html"      });

      form.addEventListener('submit', function(e) {
        e.preventDefault();
        const respostas = {};
        for (let i = 1; i <= 7; i++) {
          const val = this[`q${i}`]?.value;
          if (!val) {
            alert("Por favor, responda todas as questões!");
            return;
          }
          respostas[`q${i}`] = val;
        }
        respostas.timestamp = firebase.firestore.FieldValue.serverTimestamp();

        db.collection("usuarios").doc(user).collection("modulos").doc("modulo1").set(respostas)
          .then(() => {
            window.location.href = "modulo2.html";
      })
          .catch(err => alert("Erro ao salvar respostas: " + err.message));
      });

      function todasRespondidas() {
        const fieldsets = form.querySelectorAll("fieldset");
        return Array.from(fieldsets).every(fs =>
          Array.from(fs.querySelectorAll("input[type='radio']")).some(r => r.checked)
        );
      }

      function verificarConclusao() {
        if (videoAssistido && todasRespondidas()) {
          button.style.pointerEvents = "auto";
          button.style.opacity = "1";
          button.style.cursor = "pointer";
          button.innerHTML = "✅ Avançar para o Módulo 2";
        }
      }

      video.addEventListener("ended", () => {
        videoAssistido = true;
        verificarConclusao();
      });

      form.addEventListener("change", verificarConclusao);
    }

    const slides = document.getElementById("slides");
    const totalSlides = slides.querySelectorAll("img").length;
    let currentIndex = 0;

    window.moveSlide = function(direction) {
      currentIndex = (currentIndex + direction + totalSlides) % totalSlides;
      slides.style.transform = `translateX(-${currentIndex * 100}%)`;
      slides.style.transition = "transform 0.5s ease-in-out";
    };
  });
  </script>

  <!-- inserir no botão de concluir do módulo -->
<script>
  // finalize o módulo; scorePercent entre 0 e 100
  function finishModule_empatia(scorePercent = 100) {
    // se a central estiver aberta na mesma sessão (opener), chama diretamente
    try {
      if (window.opener && typeof window.opener.completeCourse === 'function') {
        window.opener.completeCourse('empatia', scorePercent);
        window.location.href = 'central.html';
        return;
      }
    } catch(e){ /* ignore */ }

    // fallback: grava flag para ser processada quando a central for carregada
    localStorage.setItem('courseComplete::empatia', JSON.stringify({ score: scorePercent || 100, t: Date.now() }));
    window.location.href = 'central.html';
  }
</script>
</body>
</html>