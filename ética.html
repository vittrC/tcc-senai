<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Curso 1 - Teste de √âtica no Trabalho</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Russo+One&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />

</head>
<body>

<div class="container" id="menu">
  <h1>Teste de √âtica no Ambiente de Trabalho</h1>
  <p>Bem-vindo ao simulador de dilemas √©ticos, aqui ser√° testada toda sua integridade como ser. Boa sorte!</p>
  <button class="btn" onclick="startGame()">Iniciar o Jogo</button>
  <button class="btn" onclick="showInstructions()">Instru√ß√µes</button>
  
  <div class="simple-score">
    <p>
    <span class="material-symbols-outlined" style="font-size: 27px; color: #00ff9c; position: relative; top: 6px;">emoji_events</span>
    Recorde: <span id="highScoreValue">0</span>
    </p>
    <p>√öltima pontua√ß√£o: <span id="lastScoreValue">0</span></p>
    <button id="resetScoreBtn" class="reset-btn" onclick="showResetConfirmation()">Resetar Pontua√ß√£o</button>
    <div id="resetConfirm" class="reset-confirm hidden">
      Tem certeza que deseja resetar o recorde?
      <div class="reset-options">
        <button class="btn" onclick="resetHighScore()">Sim</button>
        <button class="reset-btn" onclick="hideResetConfirmation()">N√£o</button>
      </div>
    </div>
    <a href="central.html" class="btn1">
    <i class="fas fa-right-from-bracket"></i></a>
  </div>
  
</div>

<div class="container hidden" id="instructions">
  <h2>Instru√ß√µes</h2>
  <p>
    Enfrente dilemas que podem ocorrer num ambiente de trabalho.<br>
    Cada decis√£o pode aumentar sua moral ou acabar te dando a fama de um exemplo do que N√ÉO fazer.
  </p>
  <button class="btn" onclick="backToMenu()">Voltar ao Menu</button>
</div>

<div class="container hidden" id="game">
  <h2><span class="icon-number" id="questionNumber">1</span><span id="questionTitle">Quest√£o</span></h2>
  <img id="questionGif" src="" alt="GIF da Quest√£o">
  <p id="questionText">Texto da pergunta...</p>
  <div id="answers"></div>
</div>

<div class="container hidden" id="result">
<h2>
    <span class="material-symbols-outlined" style="font-size: 37px; color: #00ff9c; position: relative; top: 8px;">sports_score</span>
    Resultado Final:
</h2>  
  <div style="display: flex; align-items: center; justify-content: center; gap: 30px; margin: 20px 0;">
    <div style="text-align: center;">
      <img id="resultAvatar" src="img/img1.png" style="width: 120px; height: 120px; border-radius: 50%; border: 3px solid #00ff00; box-shadow: 0 0 20px #00ff00;">
    </div>
    
    <div style="text-align: center;">
      <div style="font-size: 2.5em; color: #ffff00; text-shadow: 0 0 10px #ffff00; margin-bottom: 10px;">
        <span id="finalScoreValue">0</span>/<span id="totalPossibleScore">3000</span>
      </div>
      <div style="background: rgba(0, 255, 0, 0.2); padding: 10px; border-radius: 10px;">
        <p style="font-size: 1.1em;">Pontua√ß√£o M√°xima: <span id="highScoreDisplay">0</span></p>
      </div>
    </div>
  </div>

  <div id="scoreMeter" style="height: 20px; background: rgba(0, 255, 0, 0.2); border-radius: 10px; margin: 20px 0; overflow: hidden;">
    <div id="scoreProgress" style="height: 100%; background: linear-gradient(90deg, #00ff00, #00ff88); width: 0%; transition: width 1s ease;"></div>
  </div>

  <p id="finalMessage" style="font-size: 1.3em; margin: 20px 0; min-height: 60px;"></p>
  
  <div style="margin-top: 30px;">
    <button class="btn" onclick="backToMenu()">Voltar ao Menu</button>
  </div>
</div>

<script>

console.log('Avatar no localStorage:', localStorage.getItem('avatar'));

function showResetConfirmation() {
  document.getElementById("resetConfirm").classList.remove("hidden");
  document.getElementById("resetScoreBtn").classList.add("hidden");
}

function hideResetConfirmation() {
  document.getElementById("resetConfirm").classList.add("hidden");
  document.getElementById("resetScoreBtn").classList.remove("hidden");
}

function resetHighScore() {
  highScore = 0;
  localStorage.setItem('highScore', highScore);
  updateScoreDisplay();
  hideResetConfirmation();
  
  const feedback = document.createElement('div');
  feedback.textContent = 'Recorde resetado!';
  feedback.style.position = 'fixed';
  feedback.style.top = '50%';
  feedback.style.left = '50%';
  feedback.style.transform = 'translate(-50%, -50%)';
  feedback.style.color = '#ff0000';
  feedback.style.fontSize = '1.5em';
  feedback.style.textShadow = '0 0 8px #ff0000';
  feedback.style.zIndex = '1000';
  feedback.style.animation = 'fadeOut 1.5s forwards';
  feedback.style.pointerEvents = 'none'; 
  
  document.body.appendChild(feedback);
  
  setTimeout(() => {
    feedback.remove();
  }, 1500);
}

// Constantes
const POINTS_PER_CORRECT = 150;

// Perguntas do jogo 
const questions = [
  {
    title: "Acidente da Gelatina",
    text: "Em um dia comum, um colega denuncia outro por ter colocado seu grampeador em uma gelatina. Qual sua atitude?",
    gif: "gifs/etica_q1.gif",
    answers: [
      { text: "A) Re√∫ne os envolvidos para resolver discretamente.", ethical: true },
      { text: "B) Ri freneticamente enquanto aponta para o colega.", ethical: false },
      { text: "C) Espalha a hist√≥ria pelo escrit√≥rio, dando a ele o apelido de 'guloso'.", ethical: false },
      { text: "D) Recorre ao RH.", ethical: true }
    ]
  },
  {
    title: "Ass√©dio no Trabalho",
    text: "Durante uma ida √† cozinha, voc√™ v√™ seu colega constrangendo uma de suas colegas. O que voc√™ faz?",
    gif: "gifs/etica_q2.gif",
    answers: [
      { text: "A) Denuncia o comportamento para seus superiores.", ethical: true },
      { text: "B) N√£o faz nada e finge que nada aconteceu.", ethical: false },
      { text: "C) Conversa com o colega e diz que aquilo n√£o √© legal.", ethical: true }
    ]
  },
  {
    title: "Identidade Falsa",
    text: "Voc√™ descobre que seu velho colega usa um nome falso. O que voc√™ faz?",
    gif: "gifs/etica_q3.gif",
    answers: [
      { text: "A) Reporta √†s autoridades.", ethical: true },
      { text: "B) Alerta seus colegas sobre a falsa identidade.", ethical: false },
      { text: "C) Confronta-o pessoalmente, adotando postura agressiva.", ethical: false }
    ]
  },
  {
    title: "Colega no Parque",
    text: "Seu colega mente sobre estar doente para faltar ao trabalho e voc√™ descobre que ele foi ao parque aqu√°tico. O que voc√™ faz?",
    gif: "gifs/etica_q4.gif",
    answers: [
      { text: "A) dedura ele no grupo da firma com prints e marca o chefe.", ethical: false },
      { text: "B) vai tamb√©m ao parque e cobra a entrada em nome da empresa.", ethical: false },
      { text: "C) faz stories marcando ele e a empresa.", ethical: false },
      { text: "D) ignora. √âtica n√£o √© seu forte.", ethical: false },
      { text: "E) Conversa com ele em particular e sugere que seja honesto da pr√≥xima vez.", ethical: true }
    ]
  },
  {
    title: "Caf√© com Rancor",
    text: "Voc√™ nota que o caf√© da firma est√° p√©ssimo‚Äîparece √°gua suja com gosto de rancor. Seu colega, o ‚ÄúBarista‚Äù oficial, faz piadas √°cidas sobre todos que reclamam. O que voc√™ faz?",
    gif: "gifs/etica_q5.gif",
    answers: [
      { text: "A) Paga um Uber para cada funcion√°rio na cafeteria do shopping.", ethical: false },
      { text: "B) Volta na caixa de caf√© e mistura √°gua de coco para ‚Äúmelhorar o sabor‚Äù sem avisar ningu√©m.", ethical: false },
      { text: "C) Fala no grupo do trabalho: ‚ÄúParab√©ns, Barista, voc√™ transformou caf√© em arma biol√≥gica‚Äù.", ethical: true },
      { text: "D) Pega um copo de caf√© e despeja na mesa dele para demonstrar revolta.", ethical: false }
    ]
  },
  {
    title: "Chefe Atrasado",
    text: "Seu chefe chega atrasado diariamente e aponta o dedo para voc√™ quando algo d√° errado, mas chama voc√™ para carregar caixas pesadas. Como reagir?",
    gif: "gifs/etica_q6.gif",
    answers: [
      { text: "A) Bota o despertador pra tocar a cada 5 minutos at√© mandar um √°udio de madrugada: ‚ÄúChefe, bora acordar?‚Äù.", ethical: false },
      { text: "B) Aguarda o pr√≥ximo erro e fala alto: ‚ÄúClaro, foi tudo culpa do meu atraso imagin√°rio!‚Äù", ethical: true },
      { text: "C) Organiza uma vaquinha para dar um despertador a ele.", ethical: false },
      { text: "D) Torna o supervis√£o 24h no celular: manda relat√≥rios de posi√ß√£o da cama dele.", ethical: false }
    ]
  },
  {
    title: "O Lanche Roubado",
    text: "Voc√™ encontra um pacote de biscoitos escondido na gaveta do colega fissurado em snacks. Algu√©m roubou a sua metade do lanche e voc√™ est√° com fome. Qual a sa√≠da?",
    gif: "gifs/etica_q7.gif",
    answers: [
      { text: "A) Tira foto do pacote e envia editada com filtros dram√°ticos para todos no grupo.", ethical: false },
      { text: "B) Pega apenas um biscoito e deixa o resto como ‚Äúoferta de paz‚Äù.", ethical: false },
      { text: "C) Devolve o pacote sem avisar nada e coloca uma nota: ‚ÄúSinta o sabor da culpa‚Äù.", ethical: true },
      { text: "D) Substitui o estoque por biscoitos horr√≠veis de maisena e espera a vingan√ßa.", ethical: false }
    ]
  },
  {
    title: "Cliente Irritado",
    text: "Um cliente irritado liga gritando que o pedido atrasou e xinga voc√™. Voc√™, internamente, j√° planeja todas as respostas √°cidas. O que faz?",
    gif: "gifs/etica_q8.gif",
    answers: [
      { text: "A) Respira fundo e responde com calma: ‚ÄúPosso ajudar a refazer o pedido?‚Äù, ignorando o tom dele.", ethical: true },
      { text: "B) Telefona de volta fingindo ser um rob√¥ irritado: ‚ÄúDesculpe, s√≥ sirvo caf√© gelado‚Äù.", ethical: false },
      { text: "C) Desliga na cara do cliente e grava o √°udio para usar em stories.", ethical: false },
      { text: "D) Repassa o telefone para o chefe e manda mensagem: ‚ÄúChefe, virou novela mexicana aqui‚Äù.", ethical: false }
    ]
  },
  {
    title: "SOS Plantas",
    text: "Voc√™ descobre que o RH comprou plantas novas, mas ningu√©m rega. As plantas est√£o morrendo mais r√°pido que suas esperan√ßas de promo√ß√£o. Como agir?",
    gif: "gifs/etica_q9.gif",
    answers: [
      { text: "A) Pega um regador e joga √°gua nas plantas dizendo ‚Äúsobrevivam como eu tento sobreviver aqui‚Äù.", ethical: true },
      { text: "B) Substitui as plantas por bonecos de papel e aguarda admira√ß√£o geral pela ‚Äúart installation‚Äù.", ethical: false },
      { text: "C) Envia e-mail para toda a empresa: ‚ÄúSOS Vegeta√ß√£o Corporativa‚Äù.", ethical: false },
      { text: "D) Derruba todas as plantas para que ningu√©m ‚Äúsofra com a morte delas‚Äù de novo.", ethical: false }
    ]
  },
  {
    title: "Sigilo M√©dico",
    text: "Voc√™ √© m√©dico e descobre que um paciente com HIV est√° escondendo essa informa√ß√£o de seu parceiro sexual. O que voc√™ faz?",
    gif: "gifs/etica_q10.gif",
    answers: [
      { text: "A) Respeita o sigilo m√©dico e n√£o diz nada, pois √© direito do paciente.", ethical: false },
      { text: "B) Convoca uma reuni√£o com o paciente para explicar a import√¢ncia de informar o parceiro; se recusar, acaba a consulta.", ethical: true },
      { text: "C) Liga diretamente para o parceiro informando a situa√ß√£o, sem o consentimento do paciente.", ethical: false },
      { text: "D) Espera o paciente sair e manda mensagem an√¥nima ao parceiro.", ethical: false }
    ]
  },
  {
    title: "Fraude Cont√°bil",
    text: "Voc√™ trabalha como auditor e descobre fraudes cont√°beis que beneficiam a empresa, mas prejudicam funcion√°rios. Seu papel exige den√∫ncia. O que voc√™ faz?",
    gif: "gifs/etica_q8.gif",
    answers: [
      { text: "A) Fecha os olhos: ‚Äú√â s√≥ o jeito que as grandes firmas funcionam‚Äù.", ethical: false },
      { text: "B) Informa imediatamente a diretoria e prepara documenta√ß√£o para a den√∫ncia externa, mesmo sabendo que pode perder o emprego.", ethical: true },
      { text: "C) Pega uma porcentagem da diferen√ßa e guarda em um ‚Äúfundo secreto‚Äù enquanto emite relat√≥rios falsos.", ethical: false },
      { text: "D) Finge que n√£o viu e aceita um b√¥nus extra pela ‚Äúboa performance‚Äù nos n√∫meros.", ethical: false }
    ]
  },
  {
    title: "Aluno Colando",
    text: "Voc√™ √© professor e flagra um aluno colando na prova. Ele implora para n√£o estragar seu hist√≥rico. Qual atitude √©tica voc√™ toma?",
    gif: "gifs/etica_q9.gif",
    answers: [
      { text: "A) Anota como se fosse outro aluno e d√° a nota: ‚ÄúSe quer, coloco voc√™ pra outro semestre‚Äù.", ethical: false },
      { text: "B) Aplica uma nota zero e conversa em particular sobre consequ√™ncias e confian√ßa acad√™mica.", ethical: true },
      { text: "C) Deixa passar porque ‚Äútodo mundo cola uma vez na vida‚Äù.", ethical: false },
      { text: "D) Recompensa o esfor√ßo dele dizendo que aprendeu a copiar bem.", ethical: false }
    ]
  },
  {
    title: "Falha Estrutural",
    text: "Voc√™ √© engenheiro respons√°vel por projeto estrutural e percebe falha grave que s√≥ ser√° corrigida ap√≥s obra pronta. Isso implica custo alt√≠ssimo. O que faz?",
    gif: "gifs/etica_q10.gif",
    answers: [
      { text: "A) Ignora a falha para economizar e troca o laudo por uma ‚Äúavalia√ß√£o secund√°ria‚Äù.", ethical: false },
      { text: "B) Informar ao cliente e interromper imediatamente a obra, mesmo sabendo que isso pode falir a empresa.", ethical: true },
      { text: "C) Ajusta o projeto na calada da noite sem comunicar ningu√©m, ‚Äútorcendo‚Äù para que ningu√©m note.", ethical: false },
      { text: "D) Sugere cobrir o defeito com painel decorativo e esperar que o ‚Äúpeso disfarce o problema‚Äù.", ethical: false }
    ]
  },
  {
    title: "Atestado Falso",
    text: "Seu amigo pede que voc√™ falsifique atestado m√©dico para ele faltar a uma audi√™ncia judicial. Ele alega ser ‚Äúinjusti√ßa‚Äù. Como age?",
    gif: "gifs/etica_q11.gif",
    answers: [
      { text: "A) Imprime atestado vazio e manda ele assinar.", ethical: false },
      { text: "B) Negocia para que ele compare√ßa e enfrente as consequ√™ncias, explicando que falsificar documento √© crime.", ethical: true },
      { text: "C) Diz que est√° sem impressora e entrega uma declara√ß√£o desenhada √† m√£o.", ethical: false },
      { text: "D) Concorda, mas coloca um QR code que leva ao site da PF, assim ‚Äúfica divertido‚Äù.", ethical: false }
    ]
  },
  {
    title: "Medicamento com Problema",
    text: "Voc√™ trabalha em laborat√≥rio e descobre que um estudo patrocinado pela empresa omitiu efeitos colaterais graves de um medicamento. O p√∫blico pode se machucar. O que faz?",
    gif: "gifs/etica_q12.gif",
    answers: [
      { text: "A) Lan√ßa um e-mail an√¥nimo para a imprensa revelando tudo, sem verificar as fontes.", ethical: false },
      { text: "B) Comunica a equipe de pesquisa, demanda que corrijam o estudo e notifica √≥rg√£os reguladores.", ethical: true },
      { text: "C) Fura os frascos de rem√©dio para ‚Äúsuspender a produ√ß√£o‚Äù e depois diz que foi ‚Äúacidente‚Äù.", ethical: false },
      { text: "D) Vende os dados para concorrentes, pois ‚Äúpoder p√∫blico n√£o faz nada mesmo‚Äù.", ethical: false }
    ]
  },
  {
    title: "Dilema da Promo√ß√£o",
    text: "Voc√™ √© gestor e precisa escolher entre promover um funcion√°rio competente, mas com comportamento desleal, ou outro menos qualificado, por√©m √≠ntegro. Ambos disputam a mesma vaga. O que decide?",
    gif: "gifs/etica_q13.gif",
    answers: [
      { text: "A) Promove o competente, pois ‚Äúresultados justificam meios‚Äù e depois tenta ‚Äúcorrigir‚Äù o comportamento.", ethical: false },
      { text: "B) Prefere o menos qualificado com integridade, pois confian√ßa √© valor essencial para equipe.", ethical: true },
      { text: "C) Chama uma reuni√£o e deixa que os pr√≥prios funcion√°rios votem quem merece mais.", ethical: false },
      { text: "D) Cria uma ‚Äúpromo√ß√£o fantasma‚Äù e n√£o promove ningu√©m para evitar problemas.", ethical: false }
    ]
  },
  {
  title: "Estagi√°rio das Sombras",
  text: "Um estagi√°rio come√ßa a sumir misteriosamente toda tarde. Voc√™ descobre que ele est√° usando o crach√° para sair e deixar um amigo entrar e jogar videogame na sala de reuni√µes.",
  gif: "gifs/etica_q14.gif",
  answers: [
    { text: "A) Chama ele para jogar e faz campeonatos secretos com apostinhas.", ethical: false },
    { text: "B) D√° um toque: 'isso pode acabar com sua carreira antes de come√ßar'.", ethical: true },
    { text: "C) Grava tudo e vende como s√©rie no TikTok: 'O Fantasma do 14¬∫ andar'.", ethical: false },
    { text: "D) Tranca ele na sala e chama o RH com uma buzina de ar comprimido.", ethical: false }
  ]
},
{
  title: "Escuta Clandestina",
  text: "Voc√™ descobre que um colega instalou um microfone escondido para ouvir reuni√µes e tentar descobrir segredos da diretoria.",
  gif: "gifs/etica_q15.gif",
  answers: [
    { text: "A) Retira o microfone e deixa uma m√∫sica brega tocando em loop.", ethical: false },
    { text: "B) Denuncia imediatamente ao setor respons√°vel.", ethical: true },
    { text: "C) Usa o microfone para fazer pegadinhas e assustar o colega.", ethical: false },
    { text: "D) Vira s√≥cio e come√ßa a vender as grava√ß√µes como 'audiobooks corporativos'.", ethical: false }
  ]
},
{
  title: "A Impressora Vingativa",
  text: "Algu√©m usou a impressora da firma para imprimir 150 p√°ginas de memes. O gerente acha que foi voc√™.",
  gif: "gifs/etica_q16.gif",
  answers: [
    { text: "A) Assume a culpa e vira o ‚ÄòMemeiro Oficial da Semana‚Äô.", ethical: false },
    { text: "B) Aponta o verdadeiro culpado e sugere pol√≠tica clara de uso dos equipamentos.", ethical: true },
    { text: "C) Responde: 'Se fossem bons memes, eu assumia'.", ethical: false },
    { text: "D) Se vinga imprimindo o contrato de 400 p√°ginas do pr√≥prio gerente.", ethical: false }
  ]
},
{
  title: "O Caf√© do Cientista",
  text: "Um colega do laborat√≥rio come√ßa a adicionar suplementos estranhos no caf√© para testar produtividade. Ele n√£o avisa ningu√©m.",
  gif: "gifs/etica_q17.gif",
  answers: [
    { text: "A) Denuncia ao setor de sa√∫de do trabalho.", ethical: true },
    { text: "B) Participa da experi√™ncia e registra seus batimentos card√≠acos no rel√≥gio.", ethical: false },
    { text: "C) Tira foto do colega com a legenda 'Walter White do RH'.", ethical: false },
    { text: "D) Troca o caf√© por ch√° de camomila e observa os efeitos opostos.", ethical: false }
  ]
},
{
  title: "Arte de Vingan√ßa",
  text: "Um funcion√°rio desenha caricaturas ofensivas dos colegas e espalha no mural da copa. Alguns acham engra√ßado, outros est√£o magoados.",
  gif: "gifs/etica_q18.gif",
  answers: [
    { text: "A) Remove os desenhos e conversa com o autor sobre respeito e limites.", ethical: true },
    { text: "B) Faz uma exposi√ß√£o 'An√¥nimos Injusti√ßados' com direito a coquetel.", ethical: false },
    { text: "C) Pinta bigodes em todos os personagens para 'nivelar a zoeira'.", ethical: false },
    { text: "D) Responde com uma charge sua, mas expondo o sal√°rio dele.", ethical: false }
  ]
},
{
  title: "Nota Fiscal Premiada",
  text: "Um colega come√ßa a registrar despesas pessoais como se fossem da empresa para receber reembolso.",
  gif: "gifs/etica_q19.gif",
  answers: [
    { text: "A) Imita ele por uma semana e depois manda tudo em PowerPoint para o RH.", ethical: false },
    { text: "B) Fala com ele e explica que isso pode gerar demiss√£o por justa causa.", ethical: true },
    { text: "C) Come√ßa a fazer o mesmo, mas s√≥ com pizza, para ser mais discreto.", ethical: false },
    { text: "D) Fotografa o extrato e cria um grupo: 'Detetives do Reembolso'.", ethical: false }
  ]
},
{
  title: "Wi-Fi Corporativo",
  text: "Voc√™ descobre que metade do escrit√≥rio usa a internet da empresa para ver reality show ao vivo, atrapalhando o sistema interno.",
  gif: "gifs/etica_q20.gif",
  answers: [
    { text: "A) Configura o roteador para redirecionar tudo para uma palestra sobre produtividade.", ethical: false },
    { text: "B) Informa √† TI e prop√µe limitar acessos em hor√°rios cr√≠ticos.", ethical: true },
    { text: "C) Instala um projetor e transmite o reality no refeit√≥rio como 'iniciativa de bem-estar'.", ethical: false },
    { text: "D) Manda e-mail an√¥nimo: 'Big Brother acabou, galera'.", ethical: false }
  ]
}

];

let currentQuestion = 0;
let score = 0;
let highScore = localStorage.getItem('highScore') || 0;
let lastScore = localStorage.getItem('lastScore') || 0;

// Jogo principal
function startGame() {
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("game").classList.remove("hidden");
  currentQuestion = 0;
  score = 0;
  showQuestion();
}

function showQuestion() {
  if (currentQuestion >= questions.length) {
    showResult();
    return;
  }

  const question = questions[currentQuestion];
  document.getElementById("questionNumber").textContent = currentQuestion + 1;
  document.getElementById("questionTitle").textContent = question.title;
  document.getElementById("questionText").textContent = question.text;
  document.getElementById("questionGif").src = question.gif;
  
  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";
  question.answers.forEach(answer => {
    const btn = document.createElement("button");
    btn.className = "btn";
    btn.textContent = answer.text;
    btn.onclick = () => selectAnswer(answer.ethical);
    answersDiv.appendChild(btn);
  });
}

function selectAnswer(isEthical) {
  if (isEthical) score += POINTS_PER_CORRECT;
  currentQuestion++;
  if (currentQuestion < questions.length) {
    showQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  lastScore = score;
  if (score > highScore) {
    highScore = score;
    localStorage.setItem('highScore', highScore);
  }
  localStorage.setItem('lastScore', lastScore);
  
  document.getElementById("game").classList.add("hidden");
  document.getElementById("result").classList.remove("hidden");
  
  const avatarUrl = localStorage.getItem('avatar') || 'img/img1.png';
  document.getElementById("resultAvatar").src = avatarUrl;
  console.log('Avatar carregado:', avatarUrl); // Para debug
  
  const totalPoints = questions.length * POINTS_PER_CORRECT;
  
  animateValue("finalScoreValue", 0, score, 1000);
  document.getElementById("totalPossibleScore").textContent = totalPoints;
  document.getElementById("highScoreDisplay").textContent = highScore;
  
  const percentage = (score / totalPoints) * 100;
  setTimeout(() => {
    document.getElementById("scoreProgress").style.width = `${percentage}%`;
  }, 300);
  
  let message = "";
  if (percentage >= 90) message = "‚ú® √âtica Impec√°vel! Voc√™ √© um exemplo no ambiente de trabalho.";
  else if (percentage >= 70) message = "üîé Excelente! Suas decis√µes s√£o quase sempre corretas.";
  else if (percentage >= 50) message = "‚ö° Bom trabalho! Algumas escolhas poderiam ser melhores.";
  else if (percentage >= 30) message = "‚ö†Ô∏è Aten√ß√£o! Revise seus conceitos sobre √©tica profissional.";
  else message = "üö® Alerta! Suas decis√µes precisam de uma revis√£o urgente.";
  
  document.getElementById("finalMessage").textContent = message;
  
  updateScoreDisplay();
  
  localStorage.setItem("score_empatia", highScore);
}

function animateValue(id, start, end, duration) {
  const obj = document.getElementById(id);
  let startTimestamp = null;
  const step = (timestamp) => {
    if (!startTimestamp) startTimestamp = timestamp;
    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
    obj.textContent = Math.floor(progress * (end - start) + start);
    if (progress < 1) {
      window.requestAnimationFrame(step);
    }
  };
  window.requestAnimationFrame(step);
}

function showInstructions() {
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("instructions").classList.remove("hidden");
}

function backToMenu() {
  document.getElementById("instructions").classList.add("hidden");
  document.getElementById("result").classList.add("hidden");
  document.getElementById("game").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
  updateScoreDisplay();
}

function updateScoreDisplay() {
  document.getElementById('highScoreValue').textContent = highScore;
  document.getElementById('lastScoreValue').textContent = lastScore;
}

window.onload = function() {
  updateScoreDisplay();
};

</script>
</body>
</html>